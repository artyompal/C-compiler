
 Вытеснение регистров.


 Конфликтные ситуации.


 1.
 вытесняем регистр
 jcc label1
 восстанавливаем регистр
 ret
 label1:
 используем регистр

 2.
 вытесняем регистр
 jcc label1
 восстанавливаем регистр
 label1:
 используем регистр

 3.
 используем регистр
 jcc label1
 вытесняем регистр
 ret
 label1:
 используем регистр (восстанавливаем или нет?)


 
 Решение:

 Для всех базовых блоков, кроме первого блока функции, если этот блок не начинается с метки:
 нужно в конце каждого блока восстанавливать все вытесненные в нём регистры,
 а все восстановленные и до этого вытесненные нужно вытеснять обратно в память.

 Вообще, стейт в конце каждого блока не должен отличаться от стейта в начале блока.

 При этом, если блок заканчивается на ret, мы можем не генерировать код восстановления регистров, 
 а просто восстановить стейт.


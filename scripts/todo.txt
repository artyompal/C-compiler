
 TODO:


 Мелкие оптимизации:

 * Надо починить noinline-версию растеризатора.

 * Надо не сохранять неизменённые регистры, копия которых уже есть в памяти.

 * Надо заменять инструкции типа lea eax,[eax+1] на add/sub.

 * Для коммутативных операций, если первый операнд выгружен в память, а второй доступен и более ненужен,
   можно менять их местами.


 Общие алгоритмы:

 * Надо написать построение графа циклов для потока.

 * Нужно написать проверку графа на приводимость.

 * Надо написать распространение копирований. Тогда можно будет убрать все хакерские оптимизации регистровых переменных.

 * Нужно вынести константные вычисления из цикла.

 * Надо написать устранение общих подвыражений.

 * Нужно заменять вещественные деления на константу на умножения.

 * Можно освободить регистр ebp, если отказаться от стек-фреймов в статических функциях.
   Можно одним проходом после инлайнинга перевести всю адресацию с ebp на esp.

 * Надо написать оптимизацию вычисления младшего байта и записи его в int.

 * Надо кешировать доступ к часто используемым переменным в памяти.
   Регистровые переменные должны иметь возможность оказаться также в частоиспользуемых структурах и в произвольных адресуемых
   областях памяти, а переменные в стековом фрейме должны стать частным случаем.


 Оценочная функция:

 * Надо написать оценочную функцию для примерного вычисления времени выполнения функции.

 * Желательно детектировать количество итераций в простейших циклах. Тогда можно будет усовершенствовать оценочную функцию.

 * Надо написать функцию клонирования всего кода функции.
   После этого станет возможно перебирать варианты кодогенерации.

 * Можно улучшить алгоритм вытеснения регистров, если регистры, которые можно просто загрузить из памяти, не сохранять.

 * Можно улучшить алгоритм вытеснения регистров, имея оценочную функцию с информацией о внутренних циклах,
   с тем, чтобы не помещать код сохранения/восстановления регистра во внутренний цикл.

